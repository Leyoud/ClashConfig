script:
  code: |-
    def main(ctx,metadata):

      if ctx.rule_providers["Lan"].match(metadata):
        return "DIRECT"

      if ctx.rule_providers["ProcessNameDirectlist"].match(metadata):
        return "DIRECT"

      if ctx.rule_providers["Advertising"].match(metadata):
        return "ğŸ† å…¨çƒæ‹¦æˆª"

      if ctx.rule_providers["AdvertisingAppend"].match(metadata):
        return "ğŸ† å…¨çƒæ‹¦æˆª"

      if ctx.rule_providers["ChinaDirectlist"].match(metadata):
        return "ğŸ¯ å…¨çƒç›´è¿"

      if ctx.rule_providers["GoogleCN"].match(metadata):
        return "ğŸ¯ å…¨çƒç›´è¿"

      if ctx.rule_providers["SteamCN"].match(metadata):
        return "ğŸ¯ å…¨çƒç›´è¿"

      if ctx.rule_providers["AmazonCN"].match(metadata):
        return "ğŸ¯ å…¨çƒç›´è¿"

      if ctx.rule_providers["Telegram"].match(metadata):
        return "ğŸ“² ç”µæŠ¥æ¶ˆæ¯"

      if ctx.rule_providers["YouTube"].match(metadata):
        return "ğŸ“¹ æ²¹ç®¡è§†é¢‘"

      if ctx.rule_providers["TikTok"].match(metadata):
        return "ğŸ“± å›½é™…æŠ–éŸ³"

      if ctx.rule_providers["Spotify"].match(metadata):
        return "ğŸµ Spotify"

      if ctx.rule_providers["Amazon"].match(metadata):
        return "ğŸ›’ äºšé©¬é€Šå•†åŸ"

      if ctx.rule_providers["PayPal"].match(metadata):
        return "ğŸƒ PayPal"

      if ctx.rule_providers["Chatgpt"].match(metadata):
        return "ğŸ¤– Chatgpt"

      if ctx.rule_providers["Disney"].match(metadata):
        return "ğŸ¥ è¿ªå£«å°¼Plus"

      if ctx.rule_providers["Netflix"].match(metadata):
        return "ğŸ¥ å¥ˆé£è§†é¢‘"

      if ctx.rule_providers["Bahamut"].match(metadata):
        return "âœ³ï¸ å·´å“ˆå§†ç‰¹"

      if ctx.rule_providers["GlobalMedia"].match(metadata):
        return "ğŸŒ å›½å¤–åª’ä½“"

      if ctx.rule_providers["Speedtest"].match(metadata):
        return "âš¡ï¸ æµ‹é€Ÿå¹³å°"

      if ctx.rule_providers["Microsoft"].match(metadata):
        return "â“‚ï¸ å¾®è½¯æœåŠ¡"

      if ctx.rule_providers["Apple"].match(metadata):
        return "ğŸ è‹¹æœæœåŠ¡"

      if ctx.rule_providers["GoogleFCM"].match(metadata):
        return "ğŸ“¢ è°·æ­ŒFCM"

      if ctx.rule_providers["BilibiliHMT"].match(metadata):
        return "ğŸ“º å“”å“©å“”å“©"

      if ctx.rule_providers["iQIYIIntl"].match(metadata):
        return "ğŸ“º çˆ±å¥‡è‰º"

      if ctx.rule_providers["NeteaseMusic"].match(metadata):
        return "ğŸ¶ ç½‘æ˜“éŸ³ä¹"

      if ctx.rule_providers["GlobalMedia"].match(metadata):
        return "ğŸŒ å›½å†…åª’ä½“"

      if ctx.rule_providers["Epic"].match(metadata):
        return "ğŸ® æ¸¸æˆå¹³å°"

      if ctx.rule_providers["Sony"].match(metadata):
        return "ğŸ® æ¸¸æˆå¹³å°"

      if ctx.rule_providers["Steam"].match(metadata):
        return "ğŸ® æ¸¸æˆå¹³å°"

      if ctx.rule_providers["Origin"].match(metadata):
        return "ğŸ® æ¸¸æˆå¹³å°"

      if ctx.rule_providers["Nintendo"].match(metadata):
        return "ğŸ® æ¸¸æˆå¹³å°"

      if ctx.rule_providers["GlobalProxylist"].match(metadata):
        return "ğŸš€ ä»£ç†æœåŠ¡"

      if ctx.rule_providers["Global"].match(metadata):
        return "ğŸš€ ä»£ç†æœåŠ¡"

      if ctx.rule_providers["China"].match(metadata):
        return "ğŸ¯ å…¨çƒç›´è¿"

      if ctx.rule_providers["ChinaIPs"].match(metadata):
        return "ğŸ¯ å…¨çƒç›´è¿,no-resolve"

      if ctx.rule_providers["Download"].match(metadata):
        return "ğŸ¯ å…¨çƒç›´è¿"

      ip = metadata["dst_ip"]

      if ip == "":
        ip = ctx.resolve_ip(metadata["host"])

      if ctx.geoip(ip) == "CN":
        return "ğŸ¯ å…¨çƒç›´è¿"

      return "ğŸŸ æ¼ç½‘ä¹‹é±¼"